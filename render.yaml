services:
  - type: web
    name: parkhub-rust-demo
    # Pull pre-built image from GHCR — avoids 20-30 min Rust build on Render's infra
    # Image is built by GitHub Actions (.github/workflows/docker-publish.yml) on every push
    image:
      url: ghcr.io/nash87/parkhub-rust:latest
    # Pass CLI args since the Rust app doesn't read PORT env var
    dockerCommand: /app/parkhub-server --headless --unattended --data-dir /data --port 10000
    plan: free
    envVars:
      - key: RUST_LOG
        value: info
      # Note: self-registration is disabled via --unattended flag (sets allow_self_registration=false in config).
      # ALLOW_SELF_REGISTRATION is not a recognized env var — the setting lives in config.toml.
    # /data is ephemeral on Render free tier — redb resets on each restart
    # This is intentional: demo data always starts fresh
